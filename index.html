<!DOCTYPE html>
<html>
<head>
  <title>Capsul | Social media by time an place</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta charset="utf-8">

  <link href='http://fonts.googleapis.com/css?family=Signika:600,300' rel='stylesheet' type='text/css'>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCwoBQLdXCBaGaZ-JUj4efqMvlmhoerIAs&libraries=places"></script>

  <script src="http://fb.me/react-0.11.1.js"></script>
  <script src="http://fb.me/JSXTransformer-0.11.1.js"></script>


  <script type="text/javascript" src="javascript/map.js"></script>
  <script type="text/javascript" src="javascript/searchbox.js"></script>


  <script type="text/javascript" src="javascript/content/models/images.js"></script>
  <script type="text/javascript" src="javascript/content/models/text.js"></script>
  <script type="text/javascript" src="javascript/content/viewport.js"></script>
  <script type="text/javascript" src="javascript/content/dataretriever.js"></script>
  <script type="text/javascript" src="javascript/content/dataconverter.js"></script>
  <script type="text/javascript" src="javascript/capsul.js"></script>
  
  <link rel="stylesheet" type="text/css" href="css/normalize.css">
  <link rel="stylesheet" type="text/css" href="css/capsul.css">

</head>

<body ontouchstart="">
  <div id="slideshow">
    <div class="slide" style="background-image: url('images/background/burning_man.jpg')">
      <div class="slide-text">
        <h1>Black Rock Desert</h1>
        <h2>11/02/2010 at 10:45pm</h2>
        <h3>Caption lorem ipsum dolor sit amet sed</h3>
        <h3>#hashtag, #hashtag, #hashtag, #hashtag</h3>
      </div>
    </div>
  </div>

  <div id="controls">

    <header>
      <img src="images/capsul_icon_r.svg"/>
      <p>Capsul<span>social media by time and place</span></p>
    </header>

    <div id='cb-wrapper'>
      <div id='control-bar'>
        <div class="cb-datepicker">
          <h4><span><img class="cb-icon-cal" src="images/calendar_icon_r.svg"></span> PICK A DAY</h4>
          <input id="datepicker" class="date-box" type="date" name="date">
        </div>
        <div class="cb-pac">
          <h4><span><img class="cb-icon-globe" src="images/globe_icon_r.svg"></span> FIND A PLACE</h4>
          <input id="pac-input" class="search-box" type="text" placeholder="Where should we go?">
        </div>
        <div class="cb-submit">
          <input type="submit" id="button" value="">
        </div>
      </div>
      <div id="map-canvas"></div>
    </div>
    
  </div>

  <div id="granule-viewer">

  </div>

</body>

</html>

<script type="text/jsx">
  /** @jsx React.DOM */

var InstagramLogo = React.createClass({
  render: function(){
    return (
      <div className="icon instagram">
      </div>
    )
  }
});

var TwitterLogo = React.createClass({
  render: function(){
    return (
      <div className="icon twitter">
      </div>
    )
  }
});

var Username = React.createClass({
  render: function(){
    return (
        <h3>@{this.props.data}</h3>
    )
  }
});

// var Photo = React.createClass({
//   render: function() {
//     return (
//       <div className="url">
//         <img src={this.props.data} height="400px" width="400px"/>
//       </div>
//     )
//   }
// });

var Tweet = React.createClass({
  render: function(){
    return (
        <p>{this.props.data}</p>
    )
  }
});

var Hashtag = React.createClass({
  render: function(){
    return (
        <h4>{this.props.data}</h4>
    )
  }
});

var InstagramBox = React.createClass({

  render: function() {
    var picture = this.props.contentItem
    var url = "url( " + picture.url + ")"
    return (
      <div className="tile insta" style={{backgroundImage: url}}>
        <InstagramLogo />
        <div className="infobox">
          <Username data={picture.username} />
          <Hashtag data={picture.hashtag} />
        </div>
      </div>
    )
  }
});

var TweetBox = React.createClass({
  render: function() {
    var tweet = this.props.contentItem
    return (
      <div className="tile tweet">
        <TwitterLogo data={tweet.logo} />
        <Username data={tweet.username} />
        <Tweet data={tweet.content} />
        <Hashtag data={tweet.hashtag} />
      </div>
    )
  }
})

var MainViewport = React.createClass({
  getInitialState: function() {
    return { content: [] }
  },

  render: function(){
    var contentBoxes = [];

    this.state.content.forEach(function(item) {
      if (item.contentType === "text") {
      contentBoxes.push(TweetBox({contentItem: item}))
      }
      else if (item.contentType === "image") {
        contentBoxes.push(InstagramBox({contentItem: item}))
      }
    })
    return (
        <div clasName="content-container">
          {contentBoxes}
        </div>
    )
  },

  componentDidMount: function() {
    $(Viewport).on("update",function(){
      this.setState({ content: Viewport.all() })
    }.bind(this));
  }
});

React.renderComponent(
  <MainViewport />,
  document.getElementById("granule-viewer")
)
</script>



